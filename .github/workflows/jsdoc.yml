name: JSDoc Bot

on: 
  push:
    branches:
      - main

jobs:
    create_auth:
      runs-on: ubuntu-latest
      steps:
          - name: Generate Token
            id: generate-token
            uses: actions/create-github-app-token@v1
            with:
              app-id: ${{ vars.APP_ID }}
              private-key: ${{ secrets.APP_PRIVATE_KEY }}
      outputs:
        token: ${{ steps.generate-token.outputs.token }}
    create_jsdoc:
      runs-on: ubuntu-latest
      needs: create_auth
      steps:
        - uses: actions/checkout@v4
          with:
            token: ${{ needs.create_auth.outputs.token }}
        - uses: actions/setup-node@v4
          with:
            node-version: 20
        - name: Install Dependencies
          run: npm install
        - name: create Js Docs
          run: npm generate-docs
        - name: Commit Changes
          run: |
            git config --global user.name 'JSDoc Bot'
            git config --global user.email 'JSDocBot@users.noreply.github.com'
            git commit -am "Auto Generated" || echo "Nothing to Do"
            git push

              
              

          